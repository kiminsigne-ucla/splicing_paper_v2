g <- rbind(ggplotGrob(gg1), ggplotGrob(gg2), size = 'last')
id <- g$layout$t[g$layout$name == "panel"]
g$heights[id] <- unit(c(0.6, 2.4), 'null')
grid.newpage()
grid.draw(g)
ggsave(
paste0('../../figs/exac/exac_rank_order_splicing_3A', '.tiff'),
plot = g,
width = 4, height = 6, units = 'in', dpi = 600
)
source('~/splicing_paper/process_scripts/exac/exac_graph_fig3_lib_stats.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_fig3_lib_stats.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_fig3_lib_stats.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_fig3_lib_stats.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_fig4_func_annot.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_fig4_func_annot.R', echo=TRUE)
View(data)
getwd()
source("color_palette.R")
pkg <- c("readr","dplyr", "tidyr", "ggplot2", "cowplot", "grid", "gridExtra", "lazyeval", "RColorBrewer", "hrbrthemes", "tidyverse", "ggalt", "readxl", "proto", "forcats", "scales", "ggsignif", "ggthemes", "skimr", "ggseqlogo")
#"ensemblVEP"
sapply(pkg, library, character.only = TRUE)
options(stringsAsFactors = F)
options(scipen = 10000)
knitr::opts_chunk$set(warning = FALSE, message = F, echo = F, cache = T)
plot_format <- ".png"
plot_format2 <- ".svg"
lof <- data %>%
filter(v2_dpsi <= dpsi_threshold, category == "mutant")
getwd()
View(data)
table(data$snp_id)
data %>% select(id, v2_dpsi, Existing_variation, snp_id) %>% grepl("COSM")
data %>% select(Existing_variation) %>% grepl("COSM") $>$ nrow()
data %>% select(Existing_variation) %>% grepl("COSM") %>% nrow()
data %>% filter(str_detect(Existing_variation, 'COSM') %>% nrow()
lof_snp_id <- lof %>%
data %>% filter(str_detect(Existing_variation, 'COSM')) %>% nrow()
source("color_palette.R")
pkg <- c("readr","dplyr", "tidyr", "ggplot2", "cowplot", "grid", "gridExtra", "lazyeval", "RColorBrewer", "hrbrthemes", "tidyverse", "ggalt", "readxl", "proto", "forcats", "scales", "ggsignif", "ggthemes", "skimr", "ggseqlogo", "stringr")
#"ensemblVEP"
sapply(pkg, library, character.only = TRUE)
options(stringsAsFactors = F)
options(scipen = 10000)
knitr::opts_chunk$set(warning = FALSE, message = F, echo = F, cache = T)
plot_format <- ".png"
plot_format2 <- ".svg"
data %>% filter(str_detect(Existing_variation, 'COSM'))
data %>% filter(str_detect(Existing_variation, 'COSM')) %>% nrow()
data %>% filter(str_detect(snp_id, 'COSM')) %>% nrow()
data %>% filter(str_detect(snp_id, 'cosm')) %>% nrow()
data %>% filter(str_detect(Existing_variation, 'COSM')) %>% nrow()
lof %>% filter(str_detect(Existing_variation, 'COSM')) %>% nrow()
data %>% group_by(ensembl_id) %>% filter(str_detect(Existing_variation, 'COSM')) %>% nrow()
data %>% group_by(ensembl_id) %>% filter(str_detect(Existing_variation, 'COSM')) %>% nrow() %>% ungroup()
lof_cosm <- lof %>%
filter(str_detect(Existing_variation, 'COSM'))
View(lof_cosm)
lof_cosm <- lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
select(id, Existing_variation)
View(lof_cosm)
lof_cosm <- lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
select(id, SYMBOL, mean_cons_score, Existing_variation, v2_dpsi)
lof_cosm
View(lof_cosm)
lof_cosm <- lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
select(id, SYMBOL, mean_cons_score, Existing_variation, v2_dpsi)
data_cosm <- data %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
select(id, SYMBOL, mean_cons_score, Existing_variation, v2_dpsi)
lof_cosm <- lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
# mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
# unnest(Existing_variation) %>%
select(id, SYMBOL, mean_cons_score, Existing_variation, v2_dpsi, label)
View(lof_cosm)
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
# mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
# unnest(Existing_variation) %>%
select(id, SYMBOL, mean_cons_score, Existing_variation, v2_dpsi, label) %>%
group_by(ensembl_id) %>%
distinct(ensembl_id) %>%
nrow()
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
# mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
# unnest(Existing_variation) %>%
group_by(ensembl_id) %>%
distinct(ensembl_id) %>%
nrow()
data %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
# mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
# unnest(Existing_variation) %>%
group_by(ensembl_id) %>%
distinct(ensembl_id) %>%
nrow()
data %>%
# mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
# unnest(Existing_variation) %>%
group_by(ensembl_id) %>%
distinct(ensembl_id) %>%
nrow()
lof %>%
# mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
# unnest(Existing_variation) %>%
group_by(ensembl_id) %>%
distinct(ensembl_id) %>%
nrow()
#54
count_id <- function(data, id_input) {
data %>%
group_by(id_input) %>%
distinct(id_input) %>%
nrow()
}
id_count <- function(data, id_input) {
data %>%
group_by(id_input) %>%
distinct(id_input) %>%
nrow()
}
id_count(data, ensembl_id)
id_count
data %>%
id_count(ensembl_id)
id_count <- function(data, id_input) {
data %>%
group_by_(id_input) %>%
distinct(id_input) %>%
nrow()
}
data %>%
id_count(ensembl_id)
id_count <- function(data, id_input) {
data %>%
group_by_(id_input) %>%
distinct_(id_input) %>%
nrow()
}
data %>%
id_count(ensembl_id)
id_count <- function(data, id_input) {
data %>%
group_by_(id_input) %>%
distinct_(id_input) %>%
nrow()
}
data %>%
id_count("ensembl_id")
data %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("ensembl_id")
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("ensembl_id")
lof %>%
id_count("ensembl_id")
data %>%
id_count("id")
#2393
data %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
#872
lof %>%
id_count("id")
#543
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
SNPdata <- data %>%
filter(category == 'mutant')
SNPdata
SNPdata %>%
id_count("ensembl_id")
#2393
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("ensembl_id")
#872
lof %>%
id_count("ensembl_id")
#543
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("ensembl_id")
#54
SNPdata %>%
id_count("id")
#
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
#872
lof %>%
id_count("id")
#543
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
SNPdata %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("ensembl_id")
#2249
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("ensembl_id")
#872
lof %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("ensembl_id")
#543
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("ensembl_id")
SNPdata %>%
id_count("ensembl_id")
SNPdata %>%
id_count("id")
#2249
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#872
lof %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#285
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
SNPdata %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#29531
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#872
lof %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#285
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
SNPdata %>%
id_count("id")
#29531
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
#1266
lof %>%
id_count("id")
#1050
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#12662
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#1266
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#417
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
SNPdata %>%
id_count("id")
#12662
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#1266
lof %>%
id_count("id")
#417
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
SNPdata %>%
id_count("id")
#29531
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
#1266
lof %>%
id_count("id")
#1050
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
#60
########################################################
# Number of COSM ID (one SNP can have multiple IDs)
########################################################
SNPdata %>%
id_count("id")
#12662
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#1266
lof %>%
id_count("id")
#417
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
total_COSM <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
total_COSM <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation)
View(total_COSM)
distinct_id_count <- function(data, id_input) {
data %>%
group_by_(id_input) %>%
distinct_(id_input) %>%
nrow()
}
id_count <- function(data, id_input) {
data %>%
select_(id_input) %>%
nrow()
}
SNPdata %>%
id_count("id")
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
total_COSM_raw <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation)
lof_COSM_raw <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#1266
lof_SNP_raw / total_SNP_raw
total_COSM_raw <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation)
lof_COSM_raw <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#1266
lof_COSM_raw / total_COSM_raw
total_COSM_raw <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
lof_COSM_raw <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
total_COSM_raw <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
lof_COSM_raw <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#1266
lof_COSM_raw / total_COSM_raw
total_COSM_raw <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
lof_COSM_raw <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#1266
total_COSM_raw
lof_COSM_raw
lof_COSM_raw / total_COSM_raw
total_COSM_raw <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
lof_COSM_raw <- lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
mutate(Existing_variation = strsplit(Existing_variation, split = '&')) %>%
unnest(Existing_variation) %>%
id_count("id")
#1266
total_COSM_raw
lof_COSM_raw
lof_COSM_raw / total_COSM_raw
total_SNP_cosm <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
#1266
lof_SNP_cosm <- lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
#60
total_SNP_cosm
lof_SNP_cosm
lof_SNP_cosm / total_SNP_cosm
exonBKGD_total_cosm <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
distinct_id_count("ensembl_id")
#872
exonBKGD_lof_cosm <-lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
distinct_id_count("ensembl_id")
exonBKGD_total_cosm
exonBKGD_lof_cosm
exonBKGD_lof_cosm / exonBKGD_total_cosm
table(lof_cosm$label)
table(data_cosm$label)
total_SNP_cosm <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
#1266
lof_SNP_cosm <- lof %>%
filter(str_detect(Existing_variation, 'COSM')) %>%
id_count("id")
table(lof_SNP_cosm$lof)
table(lof_SNP_cosm$label)
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')) %>% table(label)
SNPdata %>%
filter(str_detect(Existing_variation, 'COSM')
)
total_cosm <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM'))
table(total_cosm$label)
lof_cosm <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM'))
table(lof_cosm$label)
lof_cosm <- lof %>%
filter(str_detect(Existing_variation, 'COSM'))
table(total_cosm$label)
total_cosm <- SNPdata %>%
filter(str_detect(Existing_variation, 'COSM'))
table(total_cosm$label)
lof_cosm <- lof %>%
filter(str_detect(Existing_variation, 'COSM'))
table(lof_cosm$label)
