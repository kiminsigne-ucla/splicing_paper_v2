source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
getwd()
setwd("~/splicing_paper/processed_data/exac/")
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
View(data)
data %>% filter(sub_id = "BRK")
data %>% filter(sub_id == "BRK")
data %>% filter(sub_id == "BRK") %>% ggplot(v2_dpsi) + geom_density()
data %>% filter(sub_id == "BRK") %>% ggplot(aes(v2_dpsi)) + geom_density()
data %>% filter(sub_id == "BRK", v2_dpsi) %>% nrow()
data %>% filter(sub_id == "BRK", v2_dpsi <= -0.5) %>% nrow()
data %>% filter(sub_id == "BRK", v2_dpsi > -0.5) %>% nrow()
data %>% filter(sub_id == "BRK", (v2_dpsi <= -0.5 | v1_dpsi <= -0.5)_ %>% nrow()
data %>% filter(sub_id == "BRK", (v2_dpsi <= -0.5 | v1_dpsi <= -0.5)) %>% nrow()
data %>% filter(sub_id == "BRK", (v2_dpsi > -0.5 | v1_dpsi > -0.5)) %>% nrow()
data %>% filter(sub_id == "SKP", (v2_dpsi > -0.5 | v1_dpsi > -0.5)) %>% nrow()
data %>% filter(sub_id == "SKP", (v2_dpsi <= -0.5 | v1_dpsi <= -0.5) %>% nrow()
q
data %>% filter(sub_id == "SKP", (v2_dpsi <= -0.5 | v1_dpsi <= -0.5)) %>% nrow()
data_all %>% filter(sub_id == "SKP", (v2_dpsi <= -0.5 | v1_dpsi <= -0.5)) %>% nrow()
data_other %>% filter(sub_id == "SKP", (v2_dpsi <= -0.5 | v1_dpsi <= -0.5)) %>% nrow()
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
View(data)
View(data_all)
View(data)
data %>% filter(sub_id == "SKP")
data_akk %>% filter(sub_id == "SKP")
data_all %>% filter(sub_id == "SKP")
View(data_other)
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
data_other
data_other %>% filter(sub_id == "SKP") + ggplot(aes(v2_index)) + geom_histogram()
data_other %>% filter(sub_id == "SKP") %>% ggplot(aes(v2_index)) + geom_histogram()
data_other %>% filter(sub_id == "SKP", v2_index <= 0.5) %>% nrow()
data_other %>% filter(sub_id == "SKP", v2_index > 0.5) %>% nrow()
data_other %>% filter(sub_id == "RANDOM-EXON", v2_index <= 0.5) %>% nrow()
View(data_other)
data_other %>% filter(ensembl_id == "RANDOM-EXON", v2_index <= 0.5) %>% nrow()
data_other %>% filter(ensembl_id == "RANDOM-EXON", v2_index > 0.5) %>% nrow()
data %>% filter(sub_id == "BRK")
data %>% filter(sub_id == "BRK", v2_index < 0.5)
data %>% filter(sub_id == "BRK", v2_dpsi <= 0.5)
data %>% filter(sub_id == "BRK", v2_dpsi <= -0.5)
data_all %>% filter(sub_id == "BRK", v2_dpsi <= -0.5)
View(data)
data_all %>% filter(sub_id == "BRK", v2_index <= 0.5)
data_all %>% filter(sub_id == "BRK", v2_index <= 0.5) %>% nrow()
data_all %>% filter(sub_id == "BRK", v2_index > 0.5) %>% nrow()
data %>% filter(sub_id != "BRK", v2_dpsi <= -0.5)
View(data)
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_fig3_lib_stats.R', echo=TRUE)
getwd("~/splicing_paper/processed_data/exac/")
setwd("~/splicing_paper/processed_data/exac/")
source('~/splicing_paper/process_scripts/exac/exac_graph_fig3_lib_stats.R', echo=TRUE)
getwd()
setwd("~/splicing_paper/processed_scripts/exac/")
setwd("~/splicing_paper/process_scripts/exac/")
source('~/splicing_paper/process_scripts/exac/exac_graph_fig3_lib_stats.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_fig4_func_annot.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_models.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_qc.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_models.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_models.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_models.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_models.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_models.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_models.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_models.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_fig4_func_annot.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_graph_fig4_func_annot.R', echo=TRUE)
View(data)
source('~/splicing_paper/process_scripts/exac/exac_graph_fig4_func_annot.R', echo=TRUE)
intolerant_percent
tolerant_percent
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_qc.R', echo=TRUE)
View(data)
data %>% filter(!is.na(index_smn1)) %>% nrow()
data %>% filter(!is.na(index_dhfr)) %>% nrow()
data %>% filter(!is.na(index_smn1)) %>% summarise(n_distinct(ensembl_id))
data %>% filter(!is.na(index_smn1), seq_type == 'mut') %>% summarise(n_distinct(ensembl_id))
data2 <- data %>% filter(!is.na(index_smn1), seq_type == 'mut')
View(data2)
data %>% filter(!is.na(index_smn1), seq_type == 'mut', rep_quality == 'high') %>% summarise(n_distinct(ensembl_id))
data2 <- data %>% filter(!is.na(index_smn1), seq_type == 'mut', rep_quality == 'high') %>% summarise(n_distinct(ensembl_id))
data %>% filter(!is.na(index_dhfr), seq_type == 'mut', rep_quality == 'high') %>% summarise(n_distinct(ensembl_id)) %>% nrow()
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
data %>% filter(!is.na(index_dhfr), seq_type == 'mut', rep_quality == 'high') %>% summarise(n_distinct(ensembl_id)) %>% nrow()
data %>% filter(!is.na(index_smn1), seq_type == 'mut', rep_quality == 'high') %>% summarise(n_distinct(ensembl_id)) %>% nrow()
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_qc.R', echo=TRUE)
data %>% filter(!is.na(index_dhfr), seq_type == 'mut', rep_quality == 'high') %>% summarise(n_distinct(ensembl_id)) %>% nrow()
data %>% filter(!is.na(index_smn1), seq_type == 'mut', rep_quality == 'high') %>% summarise(n_distinct(ensembl_id)) %>% nrow()
data %>% filter(!is.na(index_smn1), seq_type == 'mut', rep_quality == 'high') %>% nrow()
data %>% filter(!is.na(index_smn1), seq_type == 'mut', rep_quality == 'high') %>% summarise(n_distinct(ensembl_id))
data %>% filter(!is.na(index_dhfr), seq_type == 'mut', rep_quality == 'high') %>% summarise(n_distinct(ensembl_id))
data %>% filter(!is.na(index_dhfr), seq_type == 'mut', rep_quality == 'high') %>% nrow()
data %>% filter(!is.na(index_smn1), seq_type == 'mut', rep_quality == 'high') %>% nrow()
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_qc.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_qc.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
data_other <- data_all %>%
group_by(ensembl_id) %>%
filter(any(sub_id == 'SKP') | (any(ensembl_id == 'RANDOM-EXON')) ) %>%
ungroup() %>%
mutate(category = case_when(.$sub_id == 'SKP' ~ 'skipped control',
.$ensembl_id == 'RANDOM-EXON' ~ 'random nucleotides'))
data_other <- bind_rows(data_other, filter(data, category == 'control'))
# plot controls
data_other %>%
bind_rows(filter(data, category == 'natural')) %>%
ggplot(aes(v2_index)) + geom_density(aes(color = category)) +
scale_color_discrete(labels = c('broken SD/SA control', 'wild-type sequences',
'random nucleotides', 'skipped control')) +
labs(x = 'inclusion index') +
theme(legend.position = c(0.50, 0.75),
legend.title = element_blank())
ggsave('../../figs/supplement/exac_controls.png', width = 4, height = 4,
units = 'in', dpi = 300)
dpsi_threshold <- -0.50
dpsi_threshold_stringent <- -0.70
data <- data %>%
mutate(strong_lof = ifelse(v2_dpsi <= dpsi_threshold, TRUE, FALSE),
stringent_lof = ifelse(v2_dpsi <= dpsi_threshold_stringent, TRUE, FALSE))
write.table(data, '../../processed_data/exac/exac_data_clean.txt', sep = '\t',
row.names = F, quote = F)
source('~/splicing_paper/process_scripts/exac/exac_data_clean.R', echo=TRUE)
View(data_other)
data_other$category
table(data_other$category)
data_other %>%
bind_rows(filter(data, category == 'natural')) %>%
ggplot(aes(v2_index)) + geom_density(aes(color = category)) +
scale_fill_discrete(labels = c('broken SD/SA control', 'wild-type sequences',
'random nucleotides', 'skipped control')) +
labs(x = 'inclusion index') +
theme(legend.position = c(0.50, 0.75),
legend.title = element_blank()) +
scale_x_continuous(breaks = c(0, 0.2, 0.4, 0.6, 0.8, 1))
ggsave('../../figs/supplement/exac_controls.png', width = 5, height = 4,
units = 'in', dpi = 300)
data_other %>%
bind_rows(filter(data, category == 'natural')) %>%
ggplot(aes(v2_index)) + geom_density(aes(fill = category)) +
scale_fill_discrete(labels = c('broken SD/SA control', 'wild-type sequences',
'random nucleotides', 'skipped control')) +
labs(x = 'inclusion index') +
theme(legend.position = c(0.50, 0.75),
legend.title = element_blank()) +
scale_x_continuous(breaks = c(0, 0.2, 0.4, 0.6, 0.8, 1))
ggsave('../../figs/supplement/exac_controls.png', width = 5, height = 4,
units = 'in', dpi = 300)
data_other %>%
bind_rows(filter(data, category == 'natural')) %>%
ggplot(aes(v2_index)) + geom_density(aes(fill = category)) +
scale_fill_discrete(labels = c('broken SD/SA control', 'wild-type sequences',
'random nucleotides', 'skipped control')) +
labs(x = 'inclusion index') +
theme(legend.position = c(0.40, 0.75),
legend.title = element_blank()) +
scale_x_continuous(breaks = c(0, 0.2, 0.4, 0.6, 0.8, 1))
ggsave('../../figs/supplement/exac_controls.png', width = 4.5, height = 4,
units = 'in', dpi = 300)
data_other %>%
bind_rows(filter(data, category == 'natural')) %>%
ggplot(aes(v2_index)) + geom_density(aes(fill = category), alpha = 0.5) +
scale_fill_discrete(labels = c('broken SD/SA control', 'wild-type sequences',
'random nucleotides', 'skipped control')) +
labs(x = 'inclusion index') +
theme(legend.position = c(0.40, 0.75),
legend.title = element_blank()) +
scale_x_continuous(breaks = c(0, 0.2, 0.4, 0.6, 0.8, 1))
ggsave('../../figs/supplement/exac_controls.png', width = 4.5, height = 4,
units = 'in', dpi = 300)
data %>% filter(!is.na(index_smn1))
table(data)
source('~/splicing_paper/process_scripts/splicemod/splicemod_data_clean.R', echo=TRUE)
View(dhfr)
data %>% filter(!is.na(index_smn1)) %>% nrow()
View(data)
data %>% filter(!is.na(index_smn1), seq_type == 'mut') %>% nrow()
data %>% filter(!is.na(index_smn1), seq_type == 'nat') %>% nrow()
data_smn1 <- data %>% filter(!is.na(index_smn1))
data_dhfr <- data %>% filter(!is.na(index_dhfr))
table(data_smn1$seq_type)
data_smn1 <- data %>% filter(!is.na(index_smn1), replicability_smn1 == 'high')
table(data_smn1$seq_type)
data_dhfr <- data %>% filter(!is.na(index_dhfr), replicability_dhfr == 'high')
table(data_dhfr$seq_type)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
getwd()
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
View(sdv_by_category)
sdv_by_category <- data %>%
mutate(sdv = ifelse(dpsi_smn1 <= -0.50, T, F)) %>%
group_by(category) %>%
summarise(num_sdv = length(which(sdv == T)),
category_num = n()) %>%
mutate(percent_sdv = round(num_sdv / category_num), 2) %>%
arrange(desc(num_sdv))
View(sdv_by_category)
sdv_by_category <- data %>%
mutate(sdv = ifelse(dpsi_smn1 <= -0.50, T, F)) %>%
group_by(category) %>%
summarise(num_sdv = length(which(sdv == T)),
category_num = n()) %>%
mutate(percent_sdv = round(num_sdv / category_num)) %>%
mutate_all(funs(round(., 2))) %>%
arrange(desc(num_sdv))
sdv_by_category <- data %>%
mutate(sdv = ifelse(dpsi_smn1 <= -0.50, T, F)) %>%
group_by(category) %>%
summarise(num_sdv = length(which(sdv == T)),
category_num = n()) %>%
mutate(percent_sdv = num_sdv / category_num) %>%
mutate_all(funs(round(., 2))) %>%
arrange(desc(num_sdv))
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
View(sdv_by_category)
data %>% group_by(category)
data %>% group_by(category) %>% table()
data %>% group_by(category)
data2 <- data %>% group_by(category)
table(data2$category)
data2 %>% nrow()
sdv_by_category <- data %>%
mutate(sdv = ifelse(dpsi_smn1 <= -0.50, T, F)) %>%
group_by(category) %>%
summarise(num_sdv = length(which(sdv == T)),
category_num = n()) %>%
mutate(percent_sdv = num_sdv / category_num) %>%
arrange(desc(num_sdv)) %>%
ungroup()
View(sdv_by_category)
View(sdv_by_category)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
data_dhfr <- data %>% filter(!is.na(index_dhfr))
table(data_dhfr$category)
table(data_dhfr$seq_type)
data_smn1 <- data %>% filter(!is.na(index_smn1))
table(data_smn1$seq_type)
data_smn1 <- data %>% filter(!is.na(index_smn1))
table(data_smn1$seq_type)
load_pkgs <- function(pkgs){
new_pkgs <- pkgs[!(pkgs %in% installed.packages()[, 'Package'])]
if(length(new_pkgs)) install.packages(new_pkgs)
for(pkg in pkgs){
suppressWarnings(suppressMessages(library(pkg, character.only = T)))
}
}
pkgs <- c('dplyr', 'tidyr', 'ggplot2', 'cowplot', 'gridExtra', 'grid')
load_pkgs(pkgs)
options(stringsAsFactors = F, warn = -1, warnings = -1)
plot_format_main <- '.png'
plot_format <- '.png'
hi_res <- 600
lo_res <- 300
jitter_alpha <- 0.50
# custom color palette
source("../color_palette.R")
# specify new color palette
steps <- c("blue2", "cyan", "white", "yellow", "red2")
pal <- color.palette(steps, c(160, 1, 1, 160), space = "rgb")
###############################################################################
# Read in data
###############################################################################
data <- read.table('../../processed_data/splicemod/splicemod_data_clean.txt',
sep = '\t', header = T,
colClasses = c('sub_id' = 'character')) %>%
filter(rep_quality == 'high')
data_smn1 <- data %>% filter(!is.na(index_smn1))
table(data_smn1$seq_type)
data_dhfr <- data %>% filter(!is.na(index_dhfr))
table(data_dhfr$seq_type)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_qc.R', echo=TRUE)
data_dhfr <- data %>% filter(!is.na(index_dhfr))
table(data_dhfr$seq_type)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_categories.R', echo=TRUE)
View(sdv_by_category_dhfr)
View(sdv_by_category_smn1)
source('~/splicing_paper/process_scripts/splicemod/splicemod_graph_qc.R', echo=TRUE)
data %>% filter(!is.na(index_smn1)) %>% group_by(ensembl_id) %>% summarise(n_distinct(ensembl_id))
data %>% filter(!is.na(index_smn1)) %>% group_by(ensembl_id) %>% summarise(n_distinct())
data %>% filter(!is.na(index_smn1)) %>% group_by(ensembl_id) %>% nrow()
data_smn1 <- data %>% filter(!is.na(index_smn1)) %>% group_by(ensembl_id)
View(data_smn1)
data %>% filter(!is.na(index_smn1)) %>% group_by(ensembl_id) %>% nrow(count = n_distinct())
data %>% filter(!is.na(index_smn1)) %>% group_by(ensembl_id) %>% summarise(count = n_distinct())
data %>% filter(!is.na(index_smn1)) %>% group_by(ensembl_id) %>% summarise(count = n_distinct(ensembl_id))
data %>% filter(!is.na(index_smn1)) %>% summarise(count = n_distinct(ensembl_id))
View(data_smn1)
data %>% filter(!is.na(index_smn1)) %>% group_by(ensembl_id) %>% summarise(count = n_distinct(ensembl_id))
data %>% filter(!is.na(index_smn1)) %>% group_by(ensembl_id) %>% summarise(count = n_distinct(index_smn1))
data %>% filter(!is.na(index_smn1)) %>% group_by(ensembl_id) %>% summarise(count = n_distinct(index_smn1)) %>% nrow()
data %>% filter(!is.na(index_smn1), seq_type == 'mut') %>% group_by(ensembl_id) %>% summarise(count = n_distinct(index_smn1))
data %>% filter(!is.na(index_dhfr), seq_type == 'mut') %>% group_by(ensembl_id) %>% summarise(count = n_distinct(index_dhfr))
View(data)
