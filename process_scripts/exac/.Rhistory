source('~/GitHub/splicing_paper/process_scripts/exac/exac_add_annot.R', echo=TRUE)
setwd("~/GitHub/splicing_paper/process_scripts/exac")
source('~/GitHub/splicing_paper/process_scripts/exac/exac_add_annot.R', echo=TRUE)
source('~/GitHub/splicing_paper/process_scripts/exac/exac_add_annot.R', echo=TRUE)
getwd()
load_pkgs <- function(pkgs){
new_pkgs <- pkgs[!(pkgs %in% installed.packages()[, 'Package'])]
if(length(new_pkgs)) install.packages(new_pkgs)
for(pkg in pkgs){
suppressWarnings(suppressMessages(library(pkg, character.only = T)))
}
}
pkgs <- c('dplyr', 'tidyr', 'ggplot2', 'cowplot')
load_pkgs(pkgs)
options(stringsAsFactors = F, warn = -1, warnings = -1)
plot_format <- '.png'
# read in data
data <- read.table('../../processed_data/exac/exac_data_clean.txt',
sep = '\t', header = T)
###############################################################################
# extract conservation for each SNP
###############################################################################
# output bed file of SNP positions to get conservation
write.table(file = '../../processed_data/exac/snp_positions_hg38.bed',
x = data %>%
select(chr, snp_position_hg38_0based_start,
snp_position_hg38_0based_end, id) %>%
na.omit(),
sep = '\t', col.names = F, row.names = F, quote = F)
system(paste('bash',
'../run_phastCons.sh',
'../../processed_data/exac/snp_positions_hg38.bed',
'../../processed_data/exac/snp_position_cons_scores.bed'))
source('~/GitHub/splicing_paper/process_scripts/exac/exac_add_annot.R', echo=TRUE)
source('~/GitHub/splicing_paper/process_scripts/exac/exac_add_annot.R', echo=TRUE)
source('~/GitHub/splicing_paper/process_scripts/exac/exac_add_annot.R', echo=TRUE)
source('~/GitHub/splicing_paper/process_scripts/exac/exac_add_annot.R', echo=TRUE)
source('~/GitHub/splicing_paper/process_scripts/exac/exac_add_annot.R', echo=TRUE)
source('~/GitHub/splicing_paper/process_scripts/exac/exac_add_annot.R', echo=TRUE)
source('~/GitHub/splicing_paper/process_scripts/exac/exac_add_annot.R', echo=TRUE)
getwd()
getwd9
getwd()
source('~/GitHub/splicing_paper/process_scripts/exac/exac_add_annot.R', echo=TRUE)
source('~/GitHub/splicing_paper/process_scripts/exac/exac_add_annot.R', echo=TRUE)
